/* 🎯 iOS Safari特殊対策 - バランス版 */
/* スキルセクション専用のタップハイライト禁止 */
[class*="skill"],
[class*="skill"] *,
[class*="MobileSkillsSection"] *,
.skillsContentContainer,
.skillsContentContainer * {
  -webkit-tap-highlight-color: transparent !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-tap-highlight-color: rgba(255,255,255,0) !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  touch-action: manipulation !important;
  outline: none !important;
  -webkit-focus-ring-color: transparent !important;
  -webkit-highlight: none !important;
  -webkit-tap-highlight: none !important;
}

/* 画像専用の特別対策（バランス版） */
.skillsContentContainer img,
.skillsContentContainer [data-nimg],
.skillsContentContainer [data-nimg] img {
  -webkit-tap-highlight-color: transparent !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  outline: none !important;
  -webkit-focus-ring-color: transparent !important;
  -webkit-highlight: none !important;
  -webkit-tap-highlight: none !important;
  pointer-events: none !important;
  
  /* GPU加速で安定化（軽量版） */
  -webkit-transform: translateZ(0);
  will-change: auto;
}@tailwind base;
@tailwind components;
@tailwind utilities;

/* 🎯 カスタムフォントの読み込み */
@font-face {
  font-family: "PixelMplus12-Regular";
  src: url("/fonts/PixelMplus12-Regular.ttf") format("truetype");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* 🚀 高速スムーズスクロール最適化（競合問題を修正） */

/* 完全リセット - 隙間問題を根本解決 */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* 全体のスクロール最適化 */
html {
  scroll-behavior: smooth;
  /* スクロール時のパフォーマンス最適化 */
  -webkit-overflow-scrolling: touch;
  scroll-padding-top: 80px;
  margin: 0;
  padding: 0;
  
  /* 🎯 iOS Safari タップハイライト完全無効化 - 複数の方法を併用 */
  -webkit-tap-highlight-color: transparent !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-tap-highlight-color: rgba(255,255,255,0) !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  outline: none !important;
  -webkit-focus-ring-color: transparent !important;
  -webkit-highlight: none !important;
  -webkit-tap-highlight: none !important;
}

body {
  /* GPU加速でスムーズスクロール（ナビゲーションアニメーションと競合しないように調整） */
  -webkit-overflow-scrolling: touch;
  margin: 0;
  padding: 0;
  min-height: 100vh;
  
  /* 🎯 iOS Safari タップハイライト完全無効化 - body層でも適用 */
  -webkit-tap-highlight-color: transparent !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-tap-highlight-color: rgba(255,255,255,0) !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  outline: none !important;
  -webkit-focus-ring-color: transparent !important;
  -webkit-highlight: none !important;
  -webkit-tap-highlight: none !important;
}

/* 画像の遷移最適化（フォント・レイアウトに影響しないように修正） */
img:not([data-priority="true"]):not([loading="eager"]) {
  /* レイアウトシフト防止 */
  height: auto;
  max-width: 100%;
}

/* 重要画像のみに特別な最適化を適用 */
img[loading="eager"],
img[data-priority="true"] {
  /* 読み込み時のスムーズ表示 */
  transition: opacity 0.2s ease, filter 0.2s ease;

  /* 重要画像用：即座に表示開始 */
  opacity: 1;
  filter: blur(0);

  /* チラつき完全防止 */
  image-rendering: -webkit-optimize-contrast;
  image-rendering: optimizeQuality;
}

/* Next.js Image コンポーネントの最適化（アニメーションと競合しないように調整） */
[data-nimg]:not(.navText *):not(.logoText *):not(.mobileLogoText *) {
  /* 重要画像用：高速表示 */
  transition: opacity 0.1s ease, filter 0.1s ease;

  /* 即座に表示開始（重要画像） */
  opacity: 1;
  filter: blur(0);
}

/* fill画像のみ最適化 */
[data-nimg="fill"] {
  position: absolute;
  inset: 0;
  object-fit: cover;
  width: 100%;
  height: 100%;
}

/* 作品カードの最適化 */
.workCard,
.mobileWorkCard {
  /* ホバー時の滑らかな変化 */
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.workCard:hover,
.mobileWorkCard:hover {
  transform: translateY(-2px);
}

/* ローディングアニメーションの最適化 */
@keyframes smoothFadeIn {
  0% {
    opacity: 0;
    transform: translateY(10px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

.workImageContainer {
  /* 画像コンテナの最適化 */
  animation: smoothFadeIn 0.2s ease forwards;

  /* 画像のアスペクト比固定でレイアウトシフト防止 */
  aspect-ratio: 440 / 320;
  overflow: hidden;
  position: relative;
  background-color: #f5f5f5;

  img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 1;
    filter: blur(0);
  }
}

/* 重要画像最適化 */
.image-priority-high {
  opacity: 1 !important;
  filter: blur(0) !important;
  transition-duration: 0.05s !important;
}

/* GIF画像最適化 */
img[src*=".GIF"],
img[src*=".gif"] {
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

/* 🎯 ヒーロー画像専用：真っ白な画面を完全に防止 */
.heroImageWrapper {
  /* 画像再読み込み時の安定性確保 */
  position: relative;
  background: linear-gradient(
    135deg,
    #f1f3f4 0%,
    #e8eaed 50%,
    #dadce0 100%
  ) !important;
}

.heroImageWrapper img {
  /* 真っ白画面防止の最強設定 */
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;

  /* 再読み込み防止の強力な設定 */
  image-rendering: -webkit-optimize-contrast;
  image-rendering: optimizeQuality;

  /* 即座に表示 */
  filter: none !important;

  /* Next.js Imageのデフォルトスタイルを強制上書き */
  position: relative !important;
  z-index: 2 !important;
}

/* Next.js Imageコンポーネントの真っ白画面防止 */
.heroSection [data-nimg] {
  /* ヒーローセクション内の全てのImageコンポーネント */
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  transition: none !important;
}

/* 🎯 アイコングリッド専用：Next.js Linkコンポーネントの下線問題を根本解決 */
.illustrationGrid a[href],
.gridFrame a[href] {
  text-decoration: none !important;
  color: inherit !important;
}

.illustrationGrid a[href]:hover,
.gridFrame a[href]:hover {
  text-decoration: none !important;
  color: inherit !important;
}

.illustrationGrid a[href]:visited,
.gridFrame a[href]:visited {
  text-decoration: none !important;
  color: inherit !important;
}

.illustrationGrid a[href]:active,
.gridFrame a[href]:active {
  text-decoration: none !important;
  color: inherit !important;
}

.illustrationGrid a[href]:focus,
.gridFrame a[href]:focus {
  text-decoration: none !important;
  color: inherit !important;
}

/* 🚨 最終解決策：iOS Safari タップハイライト根絶（統合版） */
*,
*::before,
*::after {
  -webkit-tap-highlight-color: transparent !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  outline: none !important;
  -webkit-focus-ring-color: transparent !important;
  -webkit-highlight: none !important;
  /* touch-action は削除！スクロールを阻害するため */
}

/* 🎯 クリッカブル要素専用の完全無効化（CSS Modules対応版） */
[class*="skillCircle"],
[class*="rubyImage"],
[class*="skillCircleGrid"],
[class*="rubyImageOnly"] {
  /* iOS Safari タップハイライト根絶 */
  -webkit-tap-highlight-color: transparent !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-tap-highlight-color: rgba(255,255,255,0) !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  
  /* 重要：タッチアクションはmanipulation（スクロールは維持）*/
  touch-action: manipulation !important;
  
  /* 🚨 重要：cursor:pointerがハイライト原因のため一時的に削除 */
  cursor: default !important;
  
  /* 重要：アウトラインとフォーカスの完全無効化 */
  outline: 0 !important;
  outline: none !important;
  -webkit-focus-ring-color: transparent !important;
  -webkit-highlight: none !important;
  -webkit-tap-highlight: none !important;
  
  /* 重要：疑似クラスでの無効化 */
  &:active,
  &:focus,
  &:hover,
  &:visited {
    -webkit-tap-highlight-color: transparent !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
    outline: none !important;
    cursor: default !important;
    -webkit-focus-ring-color: transparent !important;
  }
  
  /* 重要：子要素も完全無効化（ただしスクロールは維持）*/
  *,
  *::before,
  *::after {
    -webkit-tap-highlight-color: transparent !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
    -webkit-touch-callout: none !important;
    -webkit-user-select: none !important;
    user-select: none !important;
    /* touch-action: none を削除！スクロール阻害のため */
    outline: none !important;
    cursor: default !important;
  }
  
  /* 🚨 画像要素の特別対策：pointer-events で完全無効化 */
  img,
  [data-nimg],
  [data-nimg] img {
    -webkit-tap-highlight-color: transparent !important;
    -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
    -webkit-touch-callout: none !important;
    -webkit-user-select: none !important;
    user-select: none !important;
    outline: none !important;
    cursor: default !important;
    pointer-events: none !important;
  }
}

/* Next.js Imageコンポーネント専用対策 - 青いプレースホルダー完全除去版 */
img,
[data-nimg],
[data-nimg] img,
[data-nimg="fill"],
[data-nimg="responsive"],
[data-nimg="intrinsic"],
[data-nimg="fixed"] {
  -webkit-tap-highlight-color: transparent !important;
  -webkit-tap-highlight-color: rgba(0,0,0,0) !important;
  -webkit-tap-highlight-color: rgba(255,255,255,0) !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  user-select: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  outline: none !important;
  -webkit-focus-ring-color: transparent !important;
  -webkit-highlight: none !important;
  -webkit-tap-highlight: none !important;
  
  /* 🎯 重要：青いプレースホルダー完全除去 */
  background-color: transparent !important;
  background-image: none !important;
  background-size: auto !important;
  background-repeat: no-repeat !important;
  background-position: center !important;
}
